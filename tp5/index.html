<!doctype html>
<html lang="fr">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>TP5 - Application M√©t√©o</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      background-color: #e9ebee;
      font-family: system, -apple-system, ".SFNSText-Regular", "San Francisco", "Roboto", "Segoe UI", "Helvetica Neue", "Lucida Grande", sans-serif;
      font-size: 16px;
      margin: 0 auto;
      max-width: 800px;
    }
  </style>

  <!-- CSS -->
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/weather-icons.min.css">
</head>

<body>
  <nav class="p-2">
    <a href="..">üè† Index</a> / TP5 - M√©t√©o
  </nav>

  <div id="weatherApp" class="container py-3">
    <h1 class="mb-3 text-center">Application M√©t√©o üå§</h1>

    <!-- message g√©n√©ral -->
    <div class="alert alert-info" role="alert" v-if="message">
      {{message}}
    </div>

    <!-- formulaire centr√© + styl√© -->
    <form v-on:submit="addCity" class="mb-4 d-flex justify-content-center">
      <div class="card p-3 shadow-sm" style="width: 100%; max-width: 500px; border-radius: 15px;">
        
        <label class="mb-2 fw-bold text-center">Rechercher une ville</label>

        <div class="input-group mb-2">
          <input type="search"
                 class="form-control"
                 v-model="formCityName"
                 placeholder="Saisir une ville..."
                 aria-label="Search for..."
                 autofocus
                 required
                 style="border-radius: 10px 0 0 10px;" />

          <button class="btn btn-primary" type="submit" style="border-radius: 0 10px 10px 0;">
            Go!
          </button>
        </div>

        <small class="text-muted text-center">
          {{formCityName.length}} caract√®re(s)
        </small>

        <div class="alert alert-danger mt-2" role="alert" v-if="messageForm != ''">
          {{messageForm}}
        </div>

      </div>
    </form>
    <!-- fin: formulaire -->

    <!-- bouton MA POSITION -->
    <div class="text-center">
      <button type="button"
              class="btn btn-success mb-4"
              v-on:click="maPosition">
        üìç Ma position
      </button>
    </div>

    <!-- Listing des villes -->
    <h4>Liste des villes ({{cityList.length}})</h4>
    <ul class="list-group mb-3">
      <a v-for="city in cityList"
         :key="city.name"
         v-on:click="meteo(city)"
         class="list-group-item d-flex justify-content-between align-items-center"
         style="cursor:pointer;">
        {{city.name}}
        <button v-on:click.stop="remove(city)"
                class="btn btn-secondary btn-sm"
                title="Supprimer de la liste">
          &times;
        </button>
      </a>
    </ul>

    <div class="alert alert-primary" role="alert" v-if="cityList.length==0">
      Aucune ville saisie !
    </div>

    <!-- chargement de la m√©t√©o -->
    <div v-if="cityWeatherLoading" class="mb-2">
      Chargement de la m√©t√©o...
    </div>

    <!-- meteo de la ville s√©lectionn√©e -->
    <div v-if="cityWeather">
      <div class="card" style="width: 100%;">
        <div class="card-header">
          {{cityWeather.name}} @{{cityWheaterDate}}
        </div>

        <!-- carte OpenStreetMap -->
        <iframe class="card-img-top"
                alt="Carte"
                width="100%"
                height="200"
                frameborder="0"
                scrolling="no"
                v-bind:src="'https://www.openstreetmap.org/export/embed.html?bbox='
                            + openStreetMapArea
                            + '&layer=mapnik&marker='
                            + cityWeather.coord.lat
                            + '%2C'
                            + cityWeather.coord.lon">
        </iframe>

        <div class="card-body">
          <h5 class="card-title text-center">
            <i v-bind:class="'wi wi-owm-day-' + cityWeather.weather[0].id"></i>
            {{cityWeather.main.temp}}<i class="wi wi-celsius"></i>
          </h5>
          <p class="card-text text-center">
            {{cityWeather.weather[0].description}}
          </p>
        </div>

        <ul class="list-group list-group-flush">
          <li class="list-group-item">
            <i class="wi wi-cloud"></i> Nuages : {{cityWeather.clouds.all}}%
          </li>
          <li class="list-group-item">
            <i class="wi wi-humidity"></i> Humidit√© : {{cityWeather.main.humidity}}%
          </li>
          <li class="list-group-item">
            <i class="wi wi-windy"></i> Vent : {{cityWeather.wind.speed}} km/h
          </li>
          <li class="list-group-item">
            <i class="wi wi-sunrise"></i>
            Lev√© du soleil : {{cityWheaterSunrise}}
          </li>
          <li class="list-group-item">
            <i class="wi wi-sunset"></i>
            Couch√© du soleil : {{cityWheaterSunset}}
          </li>
        </ul>
      </div>
    </div>
    <!-- fin : meteo ville s√©lectionn√©e -->
  </div>

  <!-- JS -->
  <script src="js/libs/vue.js"></script>
  <script src="js/libs/bootstrap.bundle.js"></script>
  <script src="main.js"></script>
</body>

</html>
